---
title: "Laboratorio"
author: "√ìscar Jim√©nez Osuna"
date: "20/2/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Escenario 1. Estudio de una poblaci√≥n:

Vamos a realizar un contraste de hip√≥tesis del siguiente problema. Una fabrica de rodamientos para motores el√©ctricos est√° probando un nuevo m√©todo de fabricaci√≥n el cual considera bueno si los rodamientos tienen una duraci√≥n media de funcionamiento de 11000 horas con una desviaci√≥n t√≠pica de 250 horas. Crearemos un dataset con 1000 muestras producidas con este m√©todo. Calcularemos la media y nos preguntaremos si se puede aceptar la hip√≥tesis de validez del nuevo proceso con un riesgo igual o menor al 5%.

Creamos un dataset con el n√∫mero de horas de duraci√≥n de funcionamiento de una muestra de 1000 rodamientos seg√∫n una distribuci√≥n normal con media 1100 y desviaci√≥n t√≠pica 250 horas. 

```{r}
# fijamos una semilla para obtener siempre los mismo valores
set.seed(123)
horas<-rnorm(n = 1000, mean = 11000, sd = 250)
rodamientos <- data.frame(horas)
head(rodamientos)
```

Realizaremos la gr√°fica del histograma de los datos para comprobar el comportamiento normal de los mismos:

```{r}
hist(rodamientos$horas, main = "Horas funcionamiento rodamientos", col = "blue", xlab = "N√∫mero de horas")
```
Tambi√©n podemos usar el gr√°fico Q-Q que hace una primera aproximaci√≥n visual de si hay o no normalidad. Hay que tener en cuenta que este gr√°fico es meramente descriptivo.

```{r}
qqnorm( rodamientos$horas ) # la nube de puntos 
qqline( rodamientos$horas ) # la recta
```

Interpretaci√≥n: La nube de puntos se sit√∫a sobre la recta. En un principio, visualmente se aprecia que nuestros datos cumplen el supuesto de normalidad.

#### Estad√≠stico de contraste: Media

Contraste unilateral.

1 Enunciamos las hip√≥tesis nula y alternativa:

H0 : Œº >= 11000 
H1 : Œº < 11000

2.- Elegimos como nivel de significancia Œ± = 0.05 al que le corresponde un valor cr√≠tico de z_(Œ±‚ÅÑ2) = 1.96.

3.- Elegiremos como estad√≠stico la media que calcul√°ndola sobre nuestra muestra obtenemos un valor de 11012.28.

```{r}
mean(rodamientos$horas)
```

4.- Calculamos el estad√≠stico, el p-valor y del intervalo de confianza :
 
- M√©todo del estad√≠stico:

```{r}
mu0 <- 11000
n <- 1000
Xbar <- mean(rodamientos$horas)
s <- 250
Zexp <- (Xbar-mu0)/(sqrt(s)/sqrt(n))
Zexp
```

‚Ä¢ Valor cr√≠tico: Para Œ± = 0.05, Œ±/2 = 0.025(le corresponde un valor cr√≠tico: zŒ±/2 = 1.96) ---> Zexp > zŒ±/2 ---> `Aceptamos H0`

- M√©todo del p-valor:

1) Realizar el contraste para normalidad. En este contraste la hip√≥tesis nula es la hip√≥tesis de normalidad, esto es, no hay diferencias entre nuestra distribuci√≥n y una distribuci√≥n normal con esa media y esa desviaci√≥n t√≠pica. Para contrastar la normalidad usamos el test de Shapiro-Wilk, con la funci√≥n `shapiro.test( )`.

```{r}
shapiro.test( rodamientos$horas )
```

Interpretaci√≥n: Con un p-value = 0.4765 mayor de 0.05 no podemos rechazar la hip√≥tesis nula (hip√≥tesis de normalidad). Por lo tanto, podemos concluir que nuestros datos cumplen el supuesto de normalidad.

2) Realizamos el contraste. La prueba t para una muestra se utiliza cuando tenemos una variable de medida y un valor esperado para la media, y se supone normalidad de los datos (o muestra grande). Para este contraste sobre una media utilizamos el `t.test`:

```{r}
t.test( rodamientos$horas, mu = 11000, conf.level = 0.95, alternative = "less")
```

Interpretamos los resultados. Con un p-value = 0.6964 mayor de 0.05 no podemos rechazar la hip√≥tesis nula H0. Podemos concluir que la media de los valores es 11000. El intervalo de confianza incluye el 110000 (-Inf,  11016.94).

ùë∫ùíä ùíë ùíóùíÇùíçùíêùíì ‚â§ùú∂‚Üíùêëùêûùêúùê°ùêöùê≥ùêöùê¶ùê®ùê¨ ùêáùüé

ùë∫ùíä ùíë ùíóùíÇùíçùíêùíì> ùú∂‚ÜíùêÄùêúùêûùê©ùê≠ùêöùê¶ùê®ùê¨ ùêáùüé


Con un p-value = 0.6964 > 0.05. `Aceptamos H0`, no podemos rechazar la hip√≥tesis nula (hip√≥tesis de normalidad). Por lo tanto, podemos concluir que nuestros datos cumplen el supuesto de normalidad.


IC < a 11016.94 -> 11000 pertenece al intervalo de confianza -`Aceptamos H0` 



### Escenario 2. Estudio de dos poblaciones:


```{r}
# fijamos una semilla para obtener siempre los mismo valores
set.seed(1)
horas_1<-rnorm(n = 1000, mean = 0.8, sd = 0.05)
set.seed(2)
horas_2<-rnorm(n = 1000, mean = 0.8, sd = 0.05)
soldador_1 <- data.frame(horas_1)
soldador_2 <- data.frame(horas_2)
head(soldador_1)
head(soldador_2)
```

Realizaremos laS gr√°ficaS de los histogramas de los datos para comprobar el comportamiento normal de los mismos:

```{r}
par(mfrow = c(1, 2))
hist(soldador_1$horas_1, main = "Horas soldador 1", col = "blue", xlab = "N√∫mero de horas")
hist(soldador_2$horas_2, main = "Horas soldador 2", col = "blue", xlab = "N√∫mero de horas")
```

#### Estad√≠stico de contraste: Media

Contraste bilateral partiendo de la base que ambas medias son iguales con lo que d0 = 0.

1 Enunciamos las hip√≥tesis nula y alternativa:

H0 : ùúáùë•‚àí ùúáùë¶ = ùëë0-->      Œºx - Œºy = 0 ‚Üî H0: Œºx = Œºy
H1 : ùúáùë•‚àí ùúáùë¶ ‚â† ùëë0-->      Œºx - Œºy ‚â† 0 ‚Üî H1: Œºx ‚â† Œºy

2.- Elegimos como nivel de significancia Œ± = 0.05 al que le corresponde un valor cr√≠tico de z_(Œ±‚ÅÑ2)=1.96.

3.- Elegiremos como estad√≠stico la media.

```{r}
mean(soldador_1$horas_1)
mean(soldador_2$horas_2)
mean(soldador_1$horas_1) - mean(soldador_2$horas_2)
```

4.- Calculamos el estad√≠stico, el p-valor y del intervalo de confianza :

```{r}
mu01 <- 0.8
mu02 <- 0.8
n1 <- 1200
n2 <- 1200
Xbar1 <- mean(soldador_1$horas_1)
Xbar2 <- mean(soldador_2$horas_2)
s1 <- 0.05
s2 <- 0.05
Zexp <- ((Xbar1-Xbar2)-(mu01-mu02))/ sqrt((mu01^2/n1)+(mu02^2/n2))
Zexp
```

- M√©todo del estad√≠stico:

‚Ä¢ Valor cr√≠tico: Para Œ± = 0.05, Œ±/2 = 0.025(le corresponde un valor cr√≠tico: zŒ±/2 = 1.96) ---> Zexp < zŒ±/2 ---> `Aceptamos H0`

- M√©todo del p-valor:

Realizamos el contraste. Para la prueba t para dos muestras independientes usamos la funci√≥n t.test( ), sobre muestras independientes paired = FALSE, en un contraste bilateral (de dos colas) `alternative = "two.sided"`

```{r}
t.test( soldador_1$horas_1, soldador_2$horas_2, 
        conf.level = 0.95, paired = FALSE, 
        alternative = "two.sided", var.equal = TRUE)
```

Interpretamos los resultados. Con un p-value = 0.1083 mayor de 0.05 no podemos rechazar la hip√≥tesis nula H0 de igualdad de medias. Esto es, no hay diferencias significativas entre las medias. Podemos concluir que la media de los hombres y la media de las mujeres no son distintas para el mes inicial.
[ 0.7994176 0.8030999] -> 0.8 pertenece al intervalo de confianza -`Aceptamos H0` 



